var SAAS_AUTH="https://saas-rel.haimawan.com/s/rest/api",envType="";window.CP_ENABLE_DEBUG=!1;
var CP_CONSTANT={};CP_CONSTANT.LOCAL_STORAGE_KEY="CloudPlay",CP_CONSTANT.LOCAL_STORAGE_DID_KEY="cloud_did",CP_CONSTANT.LOCAL_STORAGE_CIDS_KEY="cloudplay_cids",CP_CONSTANT.SESSION_STORAGE_KEY="CloudPlay",CP_CONSTANT.SESSION_STORAGE_GAME_OPTION_KEY="game_options",CP_CONSTANT.SESSION_STORAGE_CID_INFO_KEY="cloud_cidinfo",CP_CONSTANT.SESSION_STORAGE_ACCESS_ID_KEY="access_key_id",CP_CONSTANT.SESSION_STORAGE_CHANNEL_ID_KEY="channel_id",CP_CONSTANT.SESSION_STORAGE_TRANS_UID_KEY="trans_uid",CP_CONSTANT.SESSION_STORAGE_TRANS_INDEX_KEY="trans_index",CP_CONSTANT.CLIENT_PC=1,CP_CONSTANT.CLIENT_ANDROID=2,CP_CONSTANT.CLIENT_WEB=3,CP_CONSTANT.CLIENT_IOS=4,CP_CONSTANT.CLIENT_MAC=5,CP_CONSTANT.CLIENT_H5_IOS=6,CP_CONSTANT.CLIENT_H5_ANDROID=7,CP_CONSTANT.CLIENT_TV=8,CP_CONSTANT.OS_IPHONE="iPhone",CP_CONSTANT.OS_IPAD="iPad",CP_CONSTANT.OS_ANDROID="Android",CP_CONSTANT.DEVICE_IPHONE5="iPhone5",CP_CONSTANT.DEVICE_IPHONE5s="iPhone5s",CP_CONSTANT.DEVICE_IPHONE5c="iPhone5c",CP_CONSTANT.DEVICE_IPHONE6="iPhone6",CP_CONSTANT.DEVICE_IPHONE6s="iPhone6s",CP_CONSTANT.DEVICE_IPHONE7="iPhone7",CP_CONSTANT.DEVICE_IPHONE8="iPhone8",CP_CONSTANT.DEVICE_ANDROID_NOT_SUPPORT="AndroidNotSupport",CP_CONSTANT.DEVICE_ANDROID_LOW="AndroidLow",CP_CONSTANT.DEVICE_ANDROID_MEDIUM="AndroidMedium",CP_CONSTANT.DEVICE_ANDROID_HIGH="AndroidHigh",CP_CONSTANT.DEVICE_ANDROID_ULTRA="AndroidUltra",CP_CONSTANT.ORIENTATION_PORTRAIT="portrait",CP_CONSTANT.ORIENTATION_LANDSCAPE="landscape",CP_CONSTANT.EVENT_TOUCH_START="cp.touch_start",CP_CONSTANT.EVENT_ORIENTATION_CHANGE="cp.orientation_change",CP_CONSTANT.EVENT_PLAYER_CONNECT="cp.player_connect",CP_CONSTANT.EVENT_PLAYER_READY="cp.player_ready",CP_CONSTANT.EVENT_PLAYER_CLOSED="cp.player_closed",CP_CONSTANT.EVENT_PLAYER_ERROR="cp.player_error",CP_CONSTANT.EVENT_PLAYER_NOT_SUPPORT="cp.player_not_support",CP_CONSTANT.EVENT_PLAYER_AUDIO_START_PLAYING="cp.player_audio_start_playing",CP_CONSTANT.EVENT_STOP_GAME="cp.stop_game_internal",CP_CONSTANT.EVENT_REFRESH_PAGE_REQUIRE="cp.refresh_page_require",CP_CONSTANT.EVENT_REQ_DEVICE_ID_DONE="cp.req_did_done",CP_CONSTANT.EVENT_REQ_GAME_INFO_DONE="cp.req_game_info_done",CP_CONSTANT.EVENT_START_CLOUD_SERVICE_DONE="cp.start_cloud_service_done",CP_CONSTANT.EVENT_STOP_CLOUD_SERVICE_DONE="cp.stop_cloud_service_done",CP_CONSTANT.EVENT_INIT_DONE="cp.init_done",CP_CONSTANT.EVENT_ASYNC_LOAD_FINISHED="cp.async_load_finished",CP_CONSTANT.EVENT_PAGE_VISIBILITY="cp.page_visibility",CP_CONSTANT.EVENT_NETWORK_STATUS="cp.network_status",CP_CONSTANT.EVENT_RECONNECT="cp.reconnect",CP_CONSTANT.EVENT_GOT_STREAM_INFO="cp.got_stream_info",CP_CONSTANT.GET_CLOUD_SERVICE_TYPE_NORMAL=0,CP_CONSTANT.GET_CLOUD_SERVICE_TYPE_REFRESH_TOKEN=1,CP_CONSTANT.GET_CLOUD_SERVICE_TYPE_CHANGE_RESOLUTION=2,CP_CONSTANT.UI_MESSAGE_TYPE_UNSUPPORT="unsupport",CP_CONSTANT.UI_MESSAGE_TYPE_PORTRAIT="portrait",CP_CONSTANT.UI_MESSAGE_TYPE_LANDSCAPE="landscape",CP_CONSTANT.UI_MESSAGE_TYPE_SYSTEM="system",CP_CONSTANT.UI_MESSAGE_TYPE_IOSWECHAT="iosWeChat",CP_CONSTANT.UI_MESSAGE_TYPE_ANDROIDWECHAT="androidWeChat",CP_CONSTANT.UI_MESSAGE_TYPE_REFRESH_REQUIRED="refreshRequired",CP_CONSTANT.UI_PLAYER_CONTAINER_ID="playGameBox",CP_CONSTANT.UI_PLAYER_DIV_ID="cpPlayerDivId",CP_CONSTANT.UI_PLAYER_DIV_CLASS="cpPlayerDivClass",CP_CONSTANT.API_ACTION_GET_DID="get_did",CP_CONSTANT.API_ACTION_GET_CONFIG="get_config",CP_CONSTANT.API_ACTION_GET_CID="get_cid",CP_CONSTANT.API_ACTION_GET_CLOUD_SERVICE="get_cloud_service",CP_CONSTANT.API_ACTION_STOP_CLOUD_SERVICE="stop_cloud_service",CP_CONSTANT.API_ACTION_ID_MAP={},CP_CONSTANT.API_ACTION_ID_MAP[CP_CONSTANT.API_ACTION_GET_DID]=104,CP_CONSTANT.API_ACTION_ID_MAP[CP_CONSTANT.API_ACTION_GET_CONFIG]=108,CP_CONSTANT.API_ACTION_ID_MAP[CP_CONSTANT.API_ACTION_GET_CID]=102,CP_CONSTANT.API_ACTION_ID_MAP[CP_CONSTANT.API_ACTION_GET_CLOUD_SERVICE]=201,CP_CONSTANT.API_ACTION_ID_MAP[CP_CONSTANT.API_ACTION_STOP_CLOUD_SERVICE]=202,CP_CONSTANT.CP_STOP_REASON={is_end:"time_limit",is_error:"instance_err",forced:"forced",kick_off:"no_operation",token_expire:"token_expire",logout:"log_off",disconnect:"network_off",request_error:"request_error",multi_inst:"multi_inst",low_bitrate:"low_bitrate",load_game_failed:"load_game_failed",queue_limit:"queue_limit",instance_limit:"instance_limit",verify_failed:"verify_failed",game_over:"game_over",internal_error:"internal_error",unqueue:"unqueue",unsupport_device:"unsupport_device",unsupport_privated_mode:"unsupport_privated_mode",need_refresh_page:"need_refresh_page",async_load_js_failed:"async_load_js_failed",invalid_device_id:"invalid_device_id",internal:"internal",normal:"normal"},CP_CONSTANT.SAAS_OPERATION_CODE={interval_show_queue:1,kick_off:2,is_error:3,is_end:4,playing:5,whether_to_queue:6,queue_limit:7,crash_and_rescoring:8,asking:9,be_ready:10,stoken_refresh:11,change_resolution:12,resume_service:13,ready_pause_server:14,pause_server:15,paused_server:16,exceed_limit:21,forced_offline:22};var CP_STRING={};CP_STRING.INVALID_PARAM="参数非法: ",CP_STRING.NETWORK_ERROR="网络异常，请重新连接",CP_STRING.INTERNAL_ERROR="内部错误,请刷新重试",CP_STRING.NETWORK_UNAVALIABLE="连接出错,联网后会自动重连",CP_STRING.RECONNECT_EXCCEED_MAX="尝试重新连接次数超过上限",CP_STRING.CONNECTING="正在连接中",CP_STRING.GAME_STOPED="游戏结束, 感谢使用",CP_STRING.INVALID_RESOLUTION="游戏分辨率参数非法",CP_STRING.LOAD_JS_FAILED="加载失败,请刷新重试",CP_STRING.QUERY_PRIVATE_MODE="无痕模式下玩游戏,刷新网页后游戏将会重新开始,是否继续?",CP_STRING.GAME_INTERRUPTED="游戏中断,点击刷新页面并继续游戏",CP_STRING.LOST_QUEUE_INFO="排队信息丢失,请刷新重试",CP_STRING.CREATE_PLAYER_FAILED="创建播放器失败: ",CP_STRING.INVALID_DID="device id 非法",CP_STRING.INSTANCE_EXCEED_MAX="已超过多开上限，请关闭此页面";
var CP_ERROR_MAP={read_int_val_insession:-1e3,set_selected_res_id:-1001,set_tested_bitrate:-1002,set_cur_res_id:-1003,get_bitrate_of_res_id:-1004,flash_check_failed:-1005,ajax_req_error:-1006,title_video_head_failed:-1007,title_not_video_type:-1008,play_title_video_timeout:-1009,play_title_video_failed:-1010,get_cid:-1011,get_cloudservice:-1012,get_did:-1013,get_config:-1014,stop_cloud_service:-1015,stop_all_cloud_service:-1016,multi_player:-1017,no_player_wrap:-1018,invalid_flash_bitrate:-1019,video_player_error:-1020,video_player_disconnect:-1021,input_socket_close_and_refresh_token:-1022,dont_get_cloud_service:-1023,show_player_info_failed:-1024,show_bottom_info_failed:-1025,show_notice_failed:-1026,show_upgrade_browser_info_failed:-1027,web_socket_init_failed:-1028,web_socket_check_init_failed:-1029,flash_check_end_after_player_close:-1030,set_json_map_failed:-1031,send_pay_msg_failed:-1032,require_portal_failed:-1033,get_local_key_map_failed:-1034,save_local_key_map_failed:-1035,set_flash_cookie:-1036,require_userid_error:-1037,invalid_adjx_action:-1038,set_res_list:-1039,invalid_res_list:-1040,get_name_of_res_id:-1041,set_min_bitrate:-1042,send_req_result_with_invalid_action:-1043,ajax_decrypt_error:-1044,saas_socket_check_error:-1045,input_socket_check_error:-1046,read_countly_info_in_storage_error:-1047,save_countly_info_to_storage_error:-1048,get_did_with_invalid_countly_info:-1049,init_sdk_fun_call_multi_error:-1050,show_tips_error:-1052,call_on_scene_changed_error:-1053,get_session_storage_error:-1054,show_background_img_error:-1055,record_countly_info_error:-1056,audio_load_error:-1057,eventEmitterIsNull:-1058,on_saas_message_error:-1059,on_pay_message_error:-1060,async_load_finished_multi_call:-1061,countly_module_init_multi:-1062,js_player_inited_failed:-1063,js_player_not_inited_yet:-1064,js_player_object_not_found:-1065,input_socket_connect_multi_time:-1066,unknown_orientation:-1067,invalid_resolution_info:-1068,player_container_not_exist:-1069,game_options_param_invalid:-1070,async_load_failed:-1071,no_local_storage:-1072,no_session_storage:-1073,double_saas_socket:-1074,no_stop_pre_game:-1075},__BASE_CODE=-8765,__hmLogWarn=function(_,e,o){try{var r=console.warn;_||(r=console.log,e+=__BASE_CODE);var i=CP_getTransUID()+"_"+CP_getTransIndex();r(i+"  ["+e+"]"+(o?":  "+JSON.stringify(o):""))}catch(t){}},__hmLogError=function(_,e,o){try{var r=console.error;_||(r=console.info,e+=__BASE_CODE);var i=CP_getTransUID()+"_"+CP_getTransIndex(),t=i+"  ["+e+"]"+(o?":  "+JSON.stringify(o):"");r(t),CP_UTILS.debugAlert(t)}catch(a){}};
function __dummyFunction(){}var CP_UTILS={};CP_UTILS.IPHONE_WEIXIN_KERNEL="WeixinAppleWebKit",CP_UTILS.ANDROID_WEIXIN_KERNEL="WeixinAndroidWebKit",CP_UTILS.getBrowser=function(e){function n(e,n){return e}function t(e,n){o=e,_=n}var r,i=navigator.userAgent.toLowerCase(),o="",_=0;return(r=i.match(/msie ([\d.]+)/))?t("Trident",n(r[1])):(r=i.match(/micromessenger\/([\d.]+)/))?t(CP_UTILS.detectOS()==CP_CONSTANT.OS_IPHONE?CP_UTILS.IPHONE_WEIXIN_KERNEL:CP_UTILS.ANDROID_WEIXIN_KERNEL,n(r[1])):(r=i.match(/firefox\/([\d.]+)/))?t("Gecko",n(r[1])):(r=i.match(/chrome\/([\d.]+)/))?t("WebKit",n(r[1])):(r=i.match(/opera.([\d.]+)/))?t("Presto",n(r[1])):(r=i.match(/version\/([\d.]+).*safari/))?t("WebKit",n(r[1])):0,"kernel"==e?o:"version"==e?_:""},CP_UTILS.detectOS=function(){var e=navigator.userAgent;if(/iPhone/i.test(e))return CP_CONSTANT.OS_IPHONE;if(/iPad/i.test(e))return CP_CONSTANT.OS_IPAD;if(/Android/i.test(e))return CP_CONSTANT.OS_ANDROID;var n="Mac68K"==navigator.platform||"MacPPC"==navigator.platform||"Macintosh"==navigator.platform||"MacIntel"==navigator.platform;if(n)return"Mac";var t="X11"==navigator.platform&&!i&&!n;if(t)return"Unix";var r=String(navigator.platform).indexOf("Linux")>-1;if(r)return"Linux";var i="Win32"==navigator.platform||"Windows"==navigator.platform;if(i){var o=e.indexOf("Windows NT 5.0")>-1||e.indexOf("Windows 2000")>-1;if(o)return"Win2000";var _=e.indexOf("Windows NT 5.1")>-1||e.indexOf("Windows XP")>-1;if(_)return"WinXP";var a=e.indexOf("Windows NT 5.2")>-1||e.indexOf("Windows 2003")>-1;if(a)return"Win2003";var C=e.indexOf("Windows NT 6.0")>-1||e.indexOf("Windows Vista")>-1;if(C)return"WinVista";var T=e.indexOf("Windows NT 6.1")>-1||e.indexOf("Windows 7")>-1;if(T)return"Win7";var I=e.indexOf("Windows NT 6.2")>-1||e.indexOf("Windows 8")>-1;if(I)return"Win8";var N=e.indexOf("Windows NT 10.0")>-1||e.indexOf("Windows NT 6.4")||e.indexOf("Windows 10")>-1;if(N)return"Win10"}return"other"},CP_UTILS.isMobile=function(){for(var e=[CP_CONSTANT.OS_IPHONE,CP_CONSTANT.OS_IPAD,CP_CONSTANT.OS_ANDROID],n=CP_UTILS.detectOS(),t=0;t<e.length;t++)if(n==e[t])return!0;return!1},CP_UTILS.isInWeixin=function(){return CP_UTILS.isIniOSWeixin()||CP_UTILS.isInAndroidWeixin()},CP_UTILS.isIniOSWeixin=function(){return CP_UTILS.getBrowser("kernel")==CP_UTILS.IPHONE_WEIXIN_KERNEL},CP_UTILS.isInAndroidWeixin=function(){return CP_UTILS.getBrowser("kernel")==CP_UTILS.ANDROID_WEIXIN_KERNEL},CP_UTILS.getBasePath=function(e){var n="",t=document.getElementsByTagName("script");if(t&&t.length>0)for(var r in t)try{var i=t[r].src,o=i.indexOf(e);if(o>0){n=i.slice(0,o);break}}catch(_){}return n},CP_UTILS.hasOwnProperty=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},CP_UTILS.isWebsocketObject=function(e){try{return e&&(e instanceof WebSocket||e instanceof window.NativeWebSocket)}catch(n){return e}},CP_UTILS.websocket_send=function(e,n,t){e&&e.readyState==WebSocket.OPEN&&(t?e.send(n,t):e.send(n))},CP_UTILS.websocket_close=function(e,n){e&&(e.onopen=__dummyFunction,e.onmessage=__dummyFunction,e.onclose=__dummyFunction,n&&e.close())},CP_UTILS.mixTips=function(e,n){for(var t=0;t<n.length;t++)e=e.replace("|",n[t]);return e.replace(/\n/g,"<br />")},CP_UTILS.orientation=function(){if(!CP_UTILS.isMobile())return CP_CONSTANT.ORIENTATION_PORTRAIT;switch(window.orientation){case 0:return CP_CONSTANT.ORIENTATION_PORTRAIT;case 180:return CP_CONSTANT.ORIENTATION_PORTRAIT;case-90:return CP_CONSTANT.ORIENTATION_LANDSCAPE;case 90:return CP_CONSTANT.ORIENTATION_LANDSCAPE;default:__hmLogWarn(null,CP_ERROR_MAP.unknown_orientation,window.orientation)}return"unknown"},CP_UTILS._isDebugWebglInfoShowed=!1,CP_UTILS._webglInfo=function(e){var n=document.createElement("canvas"),t=n.getContext("experimental-webgl"),r=t.getExtension("WEBGL_debug_renderer_info"),i="";if(null!=r&&(i=t.getParameter(r[e]),i&&(i=i.toString().toUpperCase().trim())),CP_UTILS.detectOS()==CP_CONSTANT.OS_IPHONE){var o=t.getParameter(t.VERSION);o&&(o=o.toString().toUpperCase().trim(),i=i?i+"__"+o:o)}return CP_UTILS._isDebugWebglInfoShowed||(CP_UTILS._isDebugWebglInfoShowed=!0,CP_UTILS.debugAlert("render info: "+i)),i},CP_UTILS.deviceType=function(){if(window.CPEmuDevice)return window.CPEmuDevice;if(CP_UTILS.detectOS()==CP_CONSTANT.OS_IPHONE){try{var e=CP_UTILS._webglInfo("UNMASKED_RENDERER_WEBGL");if(e){if(e.indexOf("A6")>-1)return CP_CONSTANT.DEVICE_IPHONE5;if(e.indexOf("A7")>-1)return CP_CONSTANT.DEVICE_IPHONE5s;if(e.indexOf("POWERVR SGX 543")>-1)return CP_CONSTANT.DEVICE_IPHONE5c;if(e.indexOf("A8")>-1)return CP_CONSTANT.DEVICE_IPHONE6;if(e.indexOf("A9")>-1)return CP_CONSTANT.DEVICE_IPHONE6s;if(e.indexOf("A10")>-1)return CP_CONSTANT.DEVICE_IPHONE7;if(e.indexOf("A11")>-1)return CP_CONSTANT.DEVICE_IPHONE8}}catch(n){}return"iOS_UNKNOWN"}if(CP_UTILS.detectOS()==CP_CONSTANT.OS_ANDROID){try{var e=CP_UTILS._webglInfo("UNMASKED_RENDERER_WEBGL"),t={"ADRENO (TM) 505":CP_CONSTANT.DEVICE_ANDROID_MEDIUM};if(e&&t.hasOwnProperty(e))return t[e]}catch(n){}return CP_CONSTANT.DEVICE_ANDROID_MEDIUM}return"UNKNOWN"},CP_UTILS.isSupportDevice=function(){if(CP_UTILS.isMobile()){for(var e=CP_UTILS.deviceType(),n=[CP_CONSTANT.DEVICE_IPHONE5,CP_CONSTANT.DEVICE_IPHONE5s,CP_CONSTANT.DEVICE_IPHONE5c,CP_CONSTANT.DEVICE_IPHONE6,CP_CONSTANT.DEVICE_IPHONE6s,CP_CONSTANT.DEVICE_IPHONE7,CP_CONSTANT.DEVICE_ANDROID_LOW,CP_CONSTANT.DEVICE_ANDROID_MEDIUM,CP_CONSTANT.DEVICE_ANDROID_HIGH,CP_CONSTANT.DEVICE_ANDROID_ULTRA],t=0;t<n.length;t++)if(e==n[t])return!0;return!1}return!0},CP_UTILS.clientType=function(){return CP_UTILS.detectOS()==CP_CONSTANT.OS_IPHONE||CP_UTILS.detectOS()==CP_CONSTANT.OS_IPAD?CP_CONSTANT.CLIENT_H5_IOS:CP_UTILS.detectOS()==CP_CONSTANT.OS_ANDROID?CP_CONSTANT.CLIENT_H5_ANDROID:CP_CONSTANT.CLIENT_H5_IOS},CP_UTILS.getUrlQueryString=function(e){try{var n=window.location.search.match(new RegExp("[?&]"+e+"=([^&]+)","i"));return null==n||n.length<1?"":n[1]}catch(t){return""}},CP_UTILS.isPrivatedMode=function(){try{localStorage.setItem("localStorage",1),localStorage.removeItem("localStorage")}catch(e){return!0}try{sessionStorage.setItem("sessionStorage",1),sessionStorage.removeItem("sessionStorage")}catch(e){return!0}return!1},CP_UTILS.createUID=function(e){var n,t,r="",i="0123456789abcdef";for(n=0;n<8;n++)r+=i.charAt(Math.round(15*Math.random()));for(n=0;n<3;n++)for(r+="-",t=0;t<4;t++)r+=i.charAt(Math.round(15*Math.random()));r+="-";var o=(new Date).getTime();for(r+=("0000000"+o.toString(16).toUpperCase()).substr(-8),n=0;n<4;n++)r+=i.charAt(Math.round(15*Math.random()));return r+"-"+e+CP_UTILS.detectOS()+CP_UTILS.getBrowser("name")},CP_UTILS._walert=alert,CP_UTILS.alert=function(e){try{CP_UTILS._walert.call(window,e)}catch(n){}},CP_UTILS.debugAlert=function(e){try{window.HMCP_DEBUG&&CP_UTILS.alert(e)}catch(n){}},CP_UTILS.onNetworkStatus=function(e){var n=function(n){e(n)},t=function(){n(!0)},r=function(){n(!1)};window.addEventListener?(window.addEventListener("online",t,!1),window.addEventListener("offline",r,!1)):(document.body.ononline=t,document.body.onoffline=r)},CP_UTILS.getScreenWidthHeight=function(){var e=document.documentElement.clientWidth;if(CP_UTILS.isIniOSWeixin())var n=document.body.clientHeight;else var n=window.innerHeight;var t={width:e,height:n};return t},CP_UTILS.floatingBarPosition=function(){var e=document.getElementById("floatingBar"),n=e.getBoundingClientRect();return n.top},CP_UTILS.getIOSVersion=function(){var e,n=navigator.userAgent.toLowerCase();if(n.indexOf("like mac os x")>0){var t=/os [\d._]*/gi,r=n.match(t);return e=(r+"").replace(/[^0-9|_.]/gi,"").replace(/_/gi,".")}return"-1"},CP_UTILS.isIphone6Plus=function(){var e=CP_UTILS.deviceType();return e==CP_CONSTANT.DEVICE_IPHONE6&&414==window.screen.availWidth};
function _cp_customStorageInit(e){var t={};return t.setItem=function(e,_){t[e]=_},t.getItem=function(e){return t[e]},t.removeItem=function(e){CP_UTILS.hasOwnProperty(t,e)&&delete t[e]},t}function _cp_getLocalStorage(){var e=null;try{localStorage.setItem("localStorage",1),localStorage.removeItem("localStorage"),e=localStorage}catch(t){__hmLogWarn(null,CP_ERROR_MAP.no_local_storage),e=_cp_customStorageInit("localStorage")}return e}function _cp_getSessionStorage(){var e=null;try{sessionStorage.setItem("sessionStorage",1),sessionStorage.removeItem("sessionStorage"),e=sessionStorage}catch(t){__hmLogWarn(null,CP_ERROR_MAP.no_session_storage),e=_cp_customStorageInit("sessionStorage")}return e}function _cp_wrapStorage(e,t){function _(_,S){s[_]=S,e[t]=JSON.stringify(s)}function S(e){return s[e]}function n(e){return CP_UTILS.hasOwnProperty(s,e)}function o(_){CP_UTILS.hasOwnProperty(s,_)&&(delete s[_],e[t]=JSON.stringify(s))}function r(){s={},e[t]=JSON.stringify(s)}var s={};return CP_UTILS.hasOwnProperty(e,t)?s=JSON.parse(e[t]):e[t]=JSON.stringify(s),{setItem:_,getItem:S,removeItem:o,hasKey:n,clear:r}}var CP_StorageInit=function(){window.CP_localStorage=_cp_wrapStorage(_cp_getLocalStorage(),CP_CONSTANT.LOCAL_STORAGE_KEY),window.CP_sessionStorage=_cp_wrapStorage(_cp_getSessionStorage(),CP_CONSTANT.SESSION_STORAGE_KEY)},CP_getDeviceId=function(){return CP_localStorage.getItem(CP_CONSTANT.LOCAL_STORAGE_DID_KEY)},CP_storeDeviceId=function(e){CP_localStorage.setItem(CP_CONSTANT.LOCAL_STORAGE_DID_KEY,e)},CP_getTransUID=function(){return CP_sessionStorage.getItem(CP_CONSTANT.SESSION_STORAGE_TRANS_UID_KEY)},CP_setTransUID=function(e){return CP_sessionStorage.setItem(CP_CONSTANT.SESSION_STORAGE_TRANS_UID_KEY,e)},CP_getTransIndex=function(){return CP_sessionStorage.getItem(CP_CONSTANT.SESSION_STORAGE_TRANS_INDEX_KEY)},CP_setTransIndex=function(e){return CP_sessionStorage.setItem(CP_CONSTANT.SESSION_STORAGE_TRANS_INDEX_KEY,e)},CP_getAccessKeyId=function(){return CP_sessionStorage.getItem(CP_CONSTANT.SESSION_STORAGE_ACCESS_ID_KEY)},CP_getChannelId=function(){return CP_sessionStorage.getItem(CP_CONSTANT.SESSION_STORAGE_CHANNEL_ID_KEY)},CP_setAccessKeyAndChannel=function(e,t){CP_sessionStorage.setItem(CP_CONSTANT.SESSION_STORAGE_ACCESS_ID_KEY,e),CP_sessionStorage.setItem(CP_CONSTANT.SESSION_STORAGE_CHANNEL_ID_KEY,t)},CP_getGameOptions=function(){return CP_sessionStorage.getItem(CP_CONSTANT.SESSION_STORAGE_GAME_OPTION_KEY)},CP_storeGameOptions=function(e){e=JSON.parse(JSON.stringify(e)),CP_sessionStorage.setItem(CP_CONSTANT.SESSION_STORAGE_GAME_OPTION_KEY,e)},CP_getCIdInfo=function(){return CP_sessionStorage.getItem(CP_CONSTANT.SESSION_STORAGE_CID_INFO_KEY)},CP_storeCIdInfo=function(e){e=JSON.parse(JSON.stringify(e)),CP_sessionStorage.setItem(CP_CONSTANT.SESSION_STORAGE_CID_INFO_KEY,e)};
"use strict";function HM_Events(){}function EE(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function addListener(e,t,n,r,i){var s=new EE(n,r||e,i),o=prefix?prefix+t:t;return e._events[o]?e._events[o].fn?e._events[o]=[e._events[o],s]:e._events[o].push(s):(e._events[o]=s,e._eventsCount++),e}function clearEvent(e,t){0===--e._eventsCount?e._events=new HM_Events:delete e._events[t]}function HM_EventEmitter(){this._events=new HM_Events,this._eventsCount=0}var has=Object.prototype.hasOwnProperty,prefix="~";Object.create&&(HM_Events.prototype=Object.create(null),(new HM_Events).__proto__||(prefix=!1)),HM_EventEmitter.prototype.eventNames=function(){var e,t,n=[];if(0===this._eventsCount)return n;for(t in e=this._events)has.call(e,t)&&n.push(prefix?t.slice(1):t);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},HM_EventEmitter.prototype.listeners=function(e,t){var n=prefix?prefix+e:e,r=this._events[n];if(t)return!!r;if(!r)return[];if(r.fn)return[r.fn];for(var i=0,s=r.length,o=new Array(s);i<s;i++)o[i]=r[i].fn;return o},HM_EventEmitter.prototype.emit=function(e,t,n,r,i,s){var o=prefix?prefix+e:e;if(!this._events[o])return!1;var c,v,f=this._events[o],a=arguments.length;if(f.fn){switch(f.once&&this.removeListener(e,f.fn,void 0,!0),a){case 1:return f.fn.call(f.context),!0;case 2:return f.fn.call(f.context,t),!0;case 3:return f.fn.call(f.context,t,n),!0;case 4:return f.fn.call(f.context,t,n,r),!0;case 5:return f.fn.call(f.context,t,n,r,i),!0;case 6:return f.fn.call(f.context,t,n,r,i,s),!0}for(v=1,c=new Array(a-1);v<a;v++)c[v-1]=arguments[v];f.fn.apply(f.context,c)}else{var p,_=f.length;for(v=0;v<_;v++)switch(f[v].once&&this.removeListener(e,f[v].fn,void 0,!0),a){case 1:f[v].fn.call(f[v].context);break;case 2:f[v].fn.call(f[v].context,t);break;case 3:f[v].fn.call(f[v].context,t,n);break;case 4:f[v].fn.call(f[v].context,t,n,r);break;default:if(!c)for(p=1,c=new Array(a-1);p<a;p++)c[p-1]=arguments[p];f[v].fn.apply(f[v].context,c)}}return!0},HM_EventEmitter.prototype.on=function(e,t,n){return addListener(this,e,t,n,!1)},HM_EventEmitter.prototype.once=function(e,t,n){return addListener(this,e,t,n,!0)},HM_EventEmitter.prototype.removeListener=function(e,t,n,r){var i=prefix?prefix+e:e;if(!this._events[i])return this;if(!t)return clearEvent(this,i),this;var s=this._events[i];if(s.fn)s.fn!==t||r&&!s.once||n&&s.context!==n||clearEvent(this,i);else{for(var o=0,c=[],v=s.length;o<v;o++)(s[o].fn!==t||r&&!s[o].once||n&&s[o].context!==n)&&c.push(s[o]);c.length?this._events[i]=1===c.length?c[0]:c:clearEvent(this,i)}return this},HM_EventEmitter.prototype.removeAllListeners=function(e){var t;return e?(t=prefix?prefix+e:e,this._events[t]&&clearEvent(this,t)):(this._events=new HM_Events,this._eventsCount=0),this},HM_EventEmitter.prototype.off=HM_EventEmitter.prototype.removeListener,HM_EventEmitter.prototype.addListener=HM_EventEmitter.prototype.on,HM_EventEmitter.prototype.setMaxListeners=function(){return this},HM_EventEmitter.prefixed=prefix,HM_EventEmitter.HM_EventEmitter=HM_EventEmitter;
var CP_EventEmmiterCreate=function(n){function t(n,t){if(m)return m.on(c?c+n:n,t),v}function i(n,t){if(m)return n=c?c+n:n,m.off(n),m.once(n,t),v}function e(n){if(m)return m.off(c?c+n:n),v}function o(n,t,i,e,o,r){return m?(n=c?c+n:n,void 0===t?(m.emit(n),v):void 0===i?(m.emit(n,t),v):void 0===e?(m.emit(n,t,i),v):void 0===o?(m.emit(n,t,i,e),v):void 0===r?(m.emit(n,t,i,e,o),v):(m.emit(n,t,i,e,o,r),v)):v}function r(){return c?c:""}function u(){return m=null,v}function f(){return null==m}var c=n,m=new HM_EventEmitter,v=null;return v={transId:r,stop:u,isStoped:f,on:t,once:i,off:e,emit:o}};
var countly_event_id_map={start_sdk:10012,input_socket_connecting:12085,input_socket_connect_opend:10021,input_socket_connect_closed:10022,input_socket_connect_failed:12049,input_socket_check_failed:12097,input_socket_start_im:12094,input_socket_stop_im:12095,input_socket_ping_pong_delay_time:10050,input_socket_ping_pong_delay_max:10033,close_by_error:10024,normal_close:10025,frame_miss:10026,out_queue:10039,fullscreen:12001,exit_fullscreen:12002,toolbar_keyboard_btn_clicked:12006,toolbar_lag_btn_clicked:12092,toolbar_unlag_btn_clicked:12093,keyboard_setting_reset:12008,keyboard_setting_save:12009,keyboard_setting_clear_all:12051,keyboard_setting_set_game_pad:12052,auto_resolution_changed_start:12011,auto_resolution_changed_done:12012,auto_resolution_changed_fail:12013,manual_resolution_changed_start:12014,manual_resolution_changed_done:12015,manual_resolution_changed_fail:12016,user_continue:12019,loading_pic_success:12020,loading_pic_fail:12021,pre_load_backgound_done:12022,pre_load_backgound_fail:12023,title_video_loading:12024,title_video_load_done:12025,title_video_load_fail:12026,title_video_play:12027,title_video_play_done:12028,title_video_play_fail:12029,speed_test_start:12030,speed_test_done:12031,speed_test_fail:12032,audio_stream_connecting:12086,audio_stream_connected:12033,audio_stream_connect_fail:12035,audio_stream_connect_disconnected:12047,video_stream_connecting:12087,video_stream_connected:12034,video_stream_connect_fail:12036,video_stream_connect_disconnected:12048,frame_delay_timeout:12038,start_revolution:12039,frame_delay_info:12042,video_url_got:12044,video_first_frame_arrived:12045,video_visible_frame_ready:12105,low_bitrate_detected:12046,init_sdk_fun_call:12058,init_sdk_fun_call_multi_error:12106,start_game_fun_call:12059,stop_game_fun_Call:12053,check_flash_version_succeed:12056,check_flash_version_failed:12057,get_did_start:12063,get_did_succeed:12078,get_did_failed:12079,get_config_start:12084,get_config_succeed:12080,get_config_failed:12081,get_cid_start:12082,get_cid_succeed:12072,get_cid_failed:12073,get_clound_service_start:12083,get_clound_service_succeed:12074,get_clound_service_failed:12075,stop_clound_service_start:12091,stop_clound_service_succeed:12076,stop_clound_service_failed:12077,saas_socket_connecting:12088,saas_socket_opened:12089,saas_socket_closed:12090,saas_socket_failed:12050,saas_socket_message:12054,saas_socket_check_failed:12096,saas_socket_already_opened:12102,saas_socket_close_pre:12103,dont_get_cloud_service:12098,show_loading_view:12099,hide_loading_view:12100,show_info_page:12101,reconnecting:12104,init_websocket_module_result:12108,set_stop_mouse_send_flag:12110,page_closed:12111,countly_invalid_data_from_get_did:12112,countly_url_modified:12113,async_load_finished:12114,start_async_load:12115,device_un_support:12300,click_download:12301,refuse_in_privated_mode:12302,no_stop_pre_game:12303},countly_event_custom_error={decrypt_failed:-1e4,video_disconnect:-10001,saas_message_parser_error:-10002,video_stream_unknown_error:-10003,video_stream_load_failed:-10004,flash_load_failed:-10005,socket_close_by_self:-10006},scene_event_ids={12058:!0,12106:!0,12059:!0,12107:!0,12063:!0,12078:!0,12079:!0,12084:!0,12080:!0,12081:!0,12056:!0,12057:!0,12082:!0,12072:!0,12088:!0,12089:!0,12044:!0,10012:!0,12112:!0,12113:!0,12114:!0,12115:!0,12300:!0};window.CP_IS_COUNTLY_INITED=!1;var CP_CountlyInit=function(){function e(e,_){Countly.q=Countly.q||[],Countly.app_key=_,Countly.url=e,Countly.force_post=!0,Countly.fail_timeout=2,d&&(Countly.max_events=1),Countly.init()}function _(e){l||(Countly.forceSendCountlyEvent(),l=!0,setTimeout(function(){l=!1},3e3))}function t(e,_,t){c.sendCount+=1,scene_event_ids[_]&&Cloudplay.sceneChange("evnt",{eventId:_});var n=CP_getCIdInfo(),d=CP_getGameOptions(),a="";n&&CP_UTILS.hasOwnProperty(n,"cid")&&CP_UTILS.hasOwnProperty(d,"userinfo")&&(a=n.cid);var i=Date.now();i<=u&&(i=u+1),u=i,t||0==t||(t="");var s={key:"HMCPWebEvent",segmentation:{key:r,timeStamp:i+"",deviceID:CP_getDeviceId(),eventID:_,cloudID:a,channel:CP_getChannelId(),extraId:d?d.extraId:"",eventData:t,uid:d&&d.userinfo?d.userinfo.uId:"",accessKeyId:CP_getAccessKeyId(),networkType:"WIFI",netStatus:"WIFI",clientTransId:e?e:"",serverTimestamp:o}};Countly.q=Countly.q||[],Countly.q.push(["add_event",s])}if(CP_IS_COUNTLY_INITED)return void __hmLogError(null,CP_ERROR_MAP.countly_module_init_multi);window.CP_IS_COUNTLY_INITED=!0;var n=!1,o=-1,d=!1,a=1e4,i=0,c={url:"",sendCount:0,countlyModuleSendCount:0,countlyModuleSucceedCount:0,countlyModuleSendFailedCount:0},s=function(){try{if(!n)return;var e=Countly.getStatisticsInfo();c.url!=e.url&&(t(countly_event_id_map.countly_url_modified),c.url=e.url),i==c.sendCount&&c.countlyModuleSendCount==e.sendCount&&c.countlyModuleSucceedCount==e.sendSucceedCount&&c.countlyModuleSendFailedCount==e.sendFailedCount||(i=c.sendCount,c.countlyModuleSendCount=e.sendCount,c.countlyModuleSucceedCount=e.sendSucceedCount,c.countlyModuleSendFailedCount=e.sendFailedCount,c.url=e.url,Cloudplay.sceneChange("clst",{info:JSON.stringify(c)}))}catch(_){__hmLogError(null,CP_ERROR_MAP.record_countly_info_error,_.toString())}},l=!1,u=0,r=CP_UTILS.clientType();return{setServerInfo:function(_,t,a){n||(n=!0,o=a,e(_,t),d&&(c.url=_,s()))},startRecordStatisticInfo:function(){d||(d=!0,setInterval(s,a))},sendCountly:t,forceSendCountlyEventWhenClosed:_}};
var _cpIE8CorsAjax=function(t){try{var e=new XDomainRequest;/^\d+$/.test(t.timeout)&&(e.timeout=t.timeout),e.ontimeout=function(){t.done(!1,"timeout")},e.onload=function(){t.done(!0,e.responseText)},e.onprogress=function(){},e.onerror=function(){t.done(!1,"onerror: "+e.responseText)},t.data&&(postData=t.data),e.open(t.method,t.url),e.send(t.data)}catch(n){t.done(!1,"Exception: "+n.toString())}},__cp_ajax=function(t){try{var e=window.XMLHttpRequest?new window.XMLHttpRequest:window.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):null;"GET"===t.method?e.open("GET",t.url,!0):(e.open("POST",t.url,!0),e.setRequestHeader("Content-type",t.contentType)),e.onreadystatechange=function(){4===this.readyState&&this.status>=200&&this.status<300?t.done(!0,e.responseText):4===this.readyState&&t.done(!1,"invalid status: "+this.status)},"GET"==t.method?e.send():e.send(t.data)}catch(n){t.done(!1,"Exception: "+n.toString())}},cloudplay_ajax=function(t){var e=1;if(t&&CP_UTILS.hasOwnProperty(t,"tryCount")&&(e=parseInt(t.tryCount)),e<=1)return void __cp_ajax(t);var n=500;t&&CP_UTILS.hasOwnProperty(t,"retryInterval")&&(n=parseInt(t.retryInterval));var o=t.done,a=function(a,r){return a?(t.done=o,void o(!0,r)):(e-=1,0==e?(t.done=o,void o(!1,r)):void setTimeout(function(){__cp_ajax(t)},n))};t.done=a,__cp_ajax(t)};
function CP_isPortraitGame(){var e=CP_getGameOptions();return e&&e.isPortrait}function CP_getClass(e,t){if(document.getElementsByClassName)return document.getElementsByClassName(t);var n=document.getElementsByTagName(e),a=[];return n[i]["class"]==t&&(a[a.length]=n[i]),a}function CP_showLoadingView(e){for(var e=e,t=CP_getClass("div","backgroundCover"),n=document.getElementById("playGameBox"),a=t.length-1;a>=0;a--)try{n.removeChild(t[a])}catch(d){}Cloudplay.sendCountly(countly_event_id_map.show_loading_view);var i=document.getElementById("loadingBox");if(null==i){var l=document.createElement("div");l.setAttribute("class","c1");var o=document.createElement("div");o.setAttribute("class","c2");var r=document.createElement("div");r.setAttribute("class","c3");var c=document.createElement("div");c.setAttribute("class","c4");var m=document.createElement("span"),s=document.createTextNode("loading");m.appendChild(s);var u=document.createElement("div");u.appendChild(l),u.appendChild(o),u.appendChild(r),u.appendChild(c);var g=document.createElement("div");g.setAttribute("class","loading backgroundCover"),g.setAttribute("id","loadingBox"),g.appendChild(u),g.appendChild(m),n.appendChild(g);var v=CP_UTILS.getScreenWidthHeight(),p=v.width,C=v.height;if("startGame"!=e){var i=document.getElementById("loadingBox");i.setAttribute("class","loading backgroundCover"),i.setAttribute("style","width:"+p+"px; height:"+C+"px;left:0px;top:0px;")}}}function CP_hideLoadingView(){Cloudplay.sendCountly(countly_event_id_map.hide_loading_view);var e=document.getElementById("loadingBox");if(null!=e){var t=document.getElementById("playGameBox");t.removeChild(e)}}
var CP_RequestManagerCreate=function(e,_){function t(e){var _="abcdefghijklmnopqrstuvwxyz0123456789";e=e||16;for(var t="",n=0;n<e;n++)t+=_.charAt(Math.floor(Math.random()*_.length));return t}function n(e,_){var t=CryptoJS.enc.Utf8.parse(_),n=CryptoJS.AES.encrypt(e,t,{mode:CryptoJS.mode.ECB,padding:CryptoJS.pad.Pkcs7});return n.toString()}function r(e,_){var t=CryptoJS.enc.Utf8.parse(_),n=CryptoJS.AES.decrypt(e,t,{mode:CryptoJS.mode.ECB,padding:CryptoJS.pad.Pkcs7});return CryptoJS.enc.Utf8.stringify(n)}function i(e,_,t){if(!e||!_)return{};var n={};for(var r in e){var i=e[r];if(i&&i.hasOwnProperty(_)){var r=i[_];t?n[r]=i[t]||"":n[r]=i}}return n}function o(e,t){var n={};return n[CP_CONSTANT.API_ACTION_GET_DID]=countly_event_id_map.get_did_failed,n[CP_CONSTANT.API_ACTION_GET_CONFIG]=countly_event_id_map.get_config_failed,n[CP_CONSTANT.API_ACTION_GET_CID]=countly_event_id_map.get_cid_failed,n[CP_CONSTANT.API_ACTION_GET_CLOUD_SERVICE]=countly_event_id_map.get_clound_service_failed,n[CP_CONSTANT.API_ACTION_STOP_CLOUD_SERVICE]=countly_event_id_map.stop_clound_service_failed,CP_UTILS.hasOwnProperty(n,e)?void _(n[e],t?t:-1):void __hmLogError(null,CP_ERROR_MAP.send_req_result_with_invalid_action,[e,t])}function a(e,t){var n={};return n[CP_CONSTANT.API_ACTION_GET_DID]=countly_event_id_map.get_did_succeed,n[CP_CONSTANT.API_ACTION_GET_CONFIG]=countly_event_id_map.get_config_succeed,n[CP_CONSTANT.API_ACTION_GET_CID]=countly_event_id_map.get_cid_succeed,n[CP_CONSTANT.API_ACTION_GET_CLOUD_SERVICE]=countly_event_id_map.get_clound_service_succeed,n[CP_CONSTANT.API_ACTION_STOP_CLOUD_SERVICE]=countly_event_id_map.stop_clound_service_succeed,CP_UTILS.hasOwnProperty(n,e)?void _(n[e],t):void __hmLogError(null,CP_ERROR_MAP.send_req_result_with_invalid_action,[e,t])}function C(e,_,i,C){if(!(_ in CP_CONSTANT.API_ACTION_ID_MAP))return __hmLogError(null,CP_ERROR_MAP.invalid_adjx_action,[url,_]),void C(!1,{code:-2});var d=navigator||{},c={hardDecoderSupported:"1",osName:CP_UTILS.detectOS(),osVersion:CP_UTILS.detectOS(),webInfo:{installLocSignYN:"",cookieId:"",userAgent:d.userAgent,browserType:d.vendor,platform:d.platform,browserVersion:CP_UTILS.getBrowser("version"),browserKernel:CP_UTILS.getBrowser("kernel"),browserKernelVersion:navigator.appVersion.substring(navigator.appVersion.lastIndexOf("/")+1,navigator.appVersion.length),flashPlayerVersion:-1},screenInfo:{dpi:"",resolution:window.screen.width+"*"+window.screen.height}},T={accessKeyID:CP_getAccessKeyId(),channel:CP_getChannelId(),packageName:"haima",sdkVersion:SDK_VERSION},I="",N="";if(_===CP_CONSTANT.API_ACTION_GET_DID||_===CP_CONSTANT.API_ACTION_GET_CID||_===CP_CONSTANT.API_ACTION_GET_CONFIG)N=t(),I=A+N;else{var s=CP_getCIdInfo();I=s.secret_key,N=s.cid}var i={action:{actId:CP_CONSTANT.API_ACTION_ID_MAP[_],transId:(new Date).getTime()+t(4),protocol:P,random:N,sdkType:E,did:CP_getDeviceId()||"",clientTransId:e},data:n(JSON.stringify(i),I),device:n(JSON.stringify(c),I),client:n(JSON.stringify(T),I)},O={url:v,data:JSON.stringify(i),method:"POST",contentType:"text/plain",tryCount:_==CP_CONSTANT.API_ACTION_GET_DID||_==CP_CONSTANT.API_ACTION_GET_CONFIG?3:1,done:function(e,t){var n=null;if(e){if(n=JSON.parse(t),0===n.code)try{return n.data=JSON.parse(r(n.data,I)),a(_),void C(!0,n)}catch(i){__hmLogError(null,CP_ERROR_MAP.ajax_decrypt_error,[_,i.toString()]),n.code=countly_event_custom_error.decrypt_failed}}else n={code:-1};__hmLogWarn(null,CP_ERROR_MAP.ajax_req_error,[_,n.code,n.code]),o(_,n.code),C(!1,n)}};cloudplay_ajax(O)}function d(e){var t=CP_getDeviceId()||0,n={did:t,envType:envType,type:E};_(countly_event_id_map.get_did_start),C(e.transId(),CP_CONSTANT.API_ACTION_GET_DID,n,function(_,t){_?e.emit(CP_CONSTANT.EVENT_REQ_DEVICE_ID_DONE,!0,t.data):e.emit(CP_CONSTANT.EVENT_REQ_DEVICE_ID_DONE,!1,t)})}function c(e,t,n){var r={accessKeyId:CP_getAccessKeyId(),packageName:t,type:0,envType:envType};_(countly_event_id_map.get_config_start),C(e.transId(),CP_CONSTANT.API_ACTION_GET_CONFIG,r,function(e,_){if(e){var t=i(_.data.interactiveTalkInfo,"k","v");n(!0,{authData:_.data,systemConfig:i(_.data.setDataInfo,"k","v"),talkInfo:t,tipsInfo:r.tipsInfo})}else n(!1,_)})}function T(e,t,n,r,i){if(!e.isStoped()){_(countly_event_id_map.get_cid_start);var o=CP_getCIdInfo();if(o&&CP_UTILS.hasOwnProperty(o,"cid")&&o.cid)return _(countly_event_id_map.get_cid_succeed,1),u[t].cidInfo=o,void e.emit(CP_CONSTANT.EVENT_REQ_GAME_INFO_DONE,!0,u[t],!1);if(!CP_getDeviceId())return void __hmLogError(null,CP_ERROR_MAP.get_cid,["no device id"]);var a=CP_getGameOptions(),d={did:CP_getDeviceId(),type:E,userInfo:n,configInfo:r,pkgName:t,extraId:a.extraId,envType:envType,CToken:i};C(e.transId(),CP_CONSTANT.API_ACTION_GET_CID,d,function(_,n){if(_){var r=n.data,i={cid:r.cidId,saas_ws:r.msgServInfo&&r.msgServInfo.socketUrl,secret_key:r.secretKey,sign:r.sign,resolutionInfo:r.resolutionInfo,minimumBitRate:r.minimumBitRate};u[t].cidInfo=i,e.emit(CP_CONSTANT.EVENT_REQ_GAME_INFO_DONE,!0,u[t],!0)}else e.emit(CP_CONSTANT.EVENT_REQ_GAME_INFO_DONE,!1,n)})}}function I(e,_,t,n,r){return u[_]?(u[_].cidInfo=null,void T(e,_,t,n,r)):void c(e,_,function(i,o){i?(u[_]=o,T(e,_,t,n,r)):e.emit(CP_CONSTANT.EVENT_REQ_GAME_INFO_DONE,!1,o)})}function N(e,t,n,r){if(!t)return __hmLogError(null,CP_ERROR_MAP.get_cloudservice,["cidInfo is null"]),void e.emit(CP_CONSTANT.EVENT_START_CLOUD_SERVICE_DONE,!1,{code:-1});_(countly_event_id_map.get_clound_service_start);var i=CP_getGameOptions();0!=i.isArchive&&(i.isArchive=!0);var o={resId:123,cid:t.cid,sign:t.sign,priority:i.priority||0,confirm:n||0,clientType:E,orientation:1,playingtime:i.playingtime,opType:r,envType:envType,payStr:i.payStr||"",deviceType:CP_UTILS.deviceType(),isArchive:i.isArchive,bitRate:-1};C(e.transId(),CP_CONSTANT.API_ACTION_GET_CLOUD_SERVICE,o,function(_,t){_?e.emit(CP_CONSTANT.EVENT_START_CLOUD_SERVICE_DONE,!0,t.data):e.emit(CP_CONSTANT.EVENT_START_CLOUD_SERVICE_DONE,!1,t)})}function s(e,t){var n={cid:t,envType:envType};_(countly_event_id_map.stop_clound_service_start),C(e.transId(),CP_CONSTANT.API_ACTION_STOP_CLOUD_SERVICE,n,function(_,t){0===t.code?e.emit(CP_CONSTANT.EVENT_STOP_CLOUD_SERVICE_DONE,!0,t.data):e.emit(CP_CONSTANT.EVENT_STOP_CLOUD_SERVICE_DONE,!1,t)})}function O(e){return u[e]}var P="3.0.11",A="web0123456789012",E=CP_UTILS.clientType(),v=e,u={};return{reqDeviceId:d,reqGameInfo:I,startCloudService:N,stopCloudService:s,gameInfo:O}};
var _CP_loadScript=function(e,t,n,o){var a=document.createElement("script");a.src=e;var r=document.getElementsByTagName("head")[0],i=!1;a.onload=a.onreadystatechange=function(){i||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(i=!0,o(e,t,!0),a.onload=a.onreadystatechange=null,n&&r.removeChild(a))},a.onerror=function(){i=!0,o(e,t,!1),n&&r.removeChild(a)},r.appendChild(a)},CP_AsyncLoadJsFiles=function(e,t,n,o){if(t){var a=function(t,r,i){return i?(r+=1,r<e.length?void _CP_loadScript(e[r],r,n,a):void o(!0,null)):void o(!1,t)};return void _CP_loadScript(e[0],0,n,a)}for(var r=[],i=0;i<e.length;i++)r.push(!1),_CP_loadScript(e[i],i,n,function(t,n,a){if(!a)return void o(!1);r[n]=!0;for(var i=!0,d=0;d<e.length;d++)if(!r[d]){i=!1;break}i&&o(!0)})},CP_AsyncLoadCssFiles=function(e,t,n){};
var CP_GameInit=function(_,e,n,t){function o(){w.once(CP_CONSTANT.EVENT_REQ_GAME_INFO_DONE,function(_,e,t){if(_){if(CP_UTILS.debugAlert("cid: "+e.cidInfo.cid+", flag: "+t),X=e.authData,K=e.talkInfo,Y=e.tipsInfo,x=e.systemConfig,V&&(V.setAuthData(e.authData,e.talkInfo,e.tipsInfo,e.systemConfig),!Cloudplay.isSupportDevice()))return void V.showMessageView(CP_CONSTANT.UI_MESSAGE_TYPE_UNSUPPORT);var o=e.cidInfo;if(CP_storeCIdInfo(o),j=t?CP_CONSTANT.GET_CLOUD_SERVICE_TYPE_NORMAL:CP_CONSTANT.GET_CLOUD_SERVICE_TYPE_REFRESH_TOKEN,o.cid){var a=CP_localStorage.getItem(CP_CONSTANT.LOCAL_STORAGE_CIDS_KEY);a||(a={}),a[o.cid]=o.secret_key,CP_localStorage.setItem(CP_CONSTANT.LOCAL_STORAGE_CIDS_KEY,a)}if(CP_UTILS.isWebsocketObject(z)){if(z.readyState==WebSocket.OPEN)return n(countly_event_id_map.saas_socket_already_opened),void z.onopen();__hmLogError(null,CP_ERROR_MAP.double_saas_socket,z.readyState),n(countly_event_id_map.saas_socket_close_pre,z.readyState),C(),r(),CP_UTILS.websocket_close(z,!0),z=null}T(o.saas_ws)}else 10201===e.code?(CP_localStorage.removeItem(CP_CONSTANT.LOCAL_STORAGE_DID_KEY),O(CP_STRING.INVALID_DID,k.NORMAL,!1,CP_CONSTANT.CP_STOP_REASON.invalid_device_id)):10202===e.code?O(CP_STRING.INSTANCE_EXCEED_MAX,k.NORMAL,!1,CP_CONSTANT.CP_STOP_REASON.instance_limit):O(e.msg?e.msg:CP_STRING.NETWORK_ERROR,k.NORMAL,!1,CP_CONSTANT.CP_STOP_REASON.internal_error)});var _=CP_getGameOptions();G.reqGameInfo(w,_.pkg_name,_.userinfo,_.configinfo,_.c_token)}function a(_,e){w.once(CP_CONSTANT.EVENT_START_CLOUD_SERVICE_DONE,function(_,e){if(_){q=!0;var n=CP_getCIdInfo();if(!n)return void O(h?"":CP_STRING.INTERNAL_ERROR,k.NORMAL,!1,CP_CONSTANT.CP_STOP_REASON.internal_error);n.start_timestamp?b=n.start_timestamp:(b=Date.now(),n.start_timestamp=b,CP_storeCIdInfo(n)),Q=-1,V?V.setCurrentResId(e.resultId):Q=e.resultId,P()}else O(e.msg?e.msg:CP_STRING.NETWORK_ERROR,k.NORMAL,!1,CP_CONSTANT.CP_STOP_REASON.internal_error)}),G.startCloudService(w,_,e,j)}function i(_){w.once(CP_CONSTANT.EVENT_STOP_CLOUD_SERVICE_DONE,function(_,e){}),G.stopCloudService(w,_)}function C(){Z&&(clearInterval(Z),Z=null)}function r(){$&&(clearTimeout($),$=null)}function T(_){var e=CP_getGameOptions(),n=CP_getCIdInfo();if(!e||!e.userinfo)return __hmLogWarn(null,CP_ERROR_MAP.saas_socket_check_error,[h]),void O(h?"":CP_STRING.INTERNAL_ERROR,k.NORMAL,!1,CP_CONSTANT.CP_STOP_REASON.internal_error);var t=_+"/websocket?did="+CP_getDeviceId()+"&cid="+n.cid+"&uid="+e.userinfo.uId+"&appId="+CP_getAccessKeyId()+"&sign="+n.sign;s(t,0)}function s(_,e){if(!h&&Cloudplay.isOnline()){if(n(countly_event_id_map.saas_socket_connecting),e>g)return n(countly_event_id_map.saas_socket_failed),void O(K.prompt_crash,k.NORMAL,!1,CP_CONSTANT.CP_STOP_REASON.internal_error);z=new WebSocket(_);var t=z;z.onopen=function(){if(z!=t)return n(countly_event_id_map.saas_socket_check_failed,"onopen"),void __hmLogError(null,CP_ERROR_MAP.saas_socket_check_error,"onopen");if(n(countly_event_id_map.saas_socket_opened),e>0&&(e=0),Z||(Z=setInterval(function(){CP_UTILS.websocket_send(z,"")},1e4)),q){var _=V&&V.isPlayerRunning();return __hmLogWarn(null,CP_ERROR_MAP.dont_get_cloud_service,_),void n(countly_event_id_map.dont_get_cloud_service,_)}var o=CP_getCIdInfo();a(o)},z.onclose=function(o){if(z!=t)return n(countly_event_id_map.saas_socket_check_failed,"onclose"),void __hmLogError(null,CP_ERROR_MAP.saas_socket_check_error,"onclose");var a=o&&o.code?o.code:-1;n(countly_event_id_map.saas_socket_closed,a),h||(C(),r(),$=setTimeout(function(){s(_,e+1)},1e3+2e3*e))},z.onmessage=function(_){if(z!=t)return void n(countly_event_id_map.saas_socket_check_failed,"onmessage");var e=null;try{e=JSON.parse(_.data);var o=[],a=null;if(o.push(e.type),2===e.type?(a=JSON.parse(e.payload),o.push(a.operation)):o.push(encodeURIComponent(e.payload)),o.push(e.ack),o.push(e.mid),o.push(e.to),n(countly_event_id_map.saas_socket_message,o.join(",")),0===e.ack){if(1===e.type&&B){try{B(e)}catch(i){__hmLogError(null,CP_ERROR_MAP.on_pay_message_error,i.toString())}return}if(2===e.type)switch(CP_UTILS.debugAlert("operation: "+a.operation),a.operation){case CP_CONSTANT.SAAS_OPERATION_CODE.exceed_limit:O(K.toast_open_same_game,k.NORMAL,!1,CP_CONSTANT.CP_STOP_REASON.multi_inst);break;case CP_CONSTANT.SAAS_OPERATION_CODE.forced_offline:O(K.tips_forced_offline_action,k.NORMAL,!1,CP_CONSTANT.CP_STOP_REASON.token_expire);break;case CP_CONSTANT.SAAS_OPERATION_CODE.playing:var C=a.data;reconnecting=!1,n(countly_event_id_map.video_url_got,C.videoUrl),w.emit(CP_CONSTANT.EVENT_GOT_STREAM_INFO,C);break;case CP_CONSTANT.SAAS_OPERATION_CODE.interval_show_queue:if(!M){O(K.toast_wait_tooMany,k.NORMAL,!1,CP_CONSTANT.CP_STOP_REASON.queue_limit);break}var r=CP_UTILS.mixTips(K.prompt_wait_man_time,[a.data.index]);r=r.replace("|",[a.data.timeStr]),r=a.data.timeStr?r.replace("|",[a.data.timeStr]):CP_UTILS.mixTips(K.prompt_wait_message,[a.data.index]),E(r,!0),Cloudplay.sceneChange("wait");break;case CP_CONSTANT.SAAS_OPERATION_CODE.asking:E(K.toast_instance_apply,!0);break;case CP_CONSTANT.SAAS_OPERATION_CODE.be_ready:break;case CP_CONSTANT.SAAS_OPERATION_CODE.whether_to_queue:var r=CP_UTILS.mixTips(K.toast_wait_choose,[a.data.index]);S(r);break;case CP_CONSTANT.SAAS_OPERATION_CODE.is_error:var r=K.prompt_hmcp_error;O(r,k.KEEP_GAME_OPTION,!1,CP_CONSTANT.CP_STOP_REASON.is_error);break;case CP_CONSTANT.SAAS_OPERATION_CODE.crash_and_rescoring:var r=K.prompt_crash;E(r),w.emit(CP_CONSTANT.EVENT_RECONNECT,-1);break;case CP_CONSTANT.SAAS_OPERATION_CODE.is_end:var r=K.prompt_game_over;O(r,k.NORMAL,!1,CP_CONSTANT.CP_STOP_REASON.is_end);break;case CP_CONSTANT.SAAS_OPERATION_CODE.kick_off:var r=K.toast_no_input;O(r,k.KEEP_GAME_OPTION,!1,CP_CONSTANT.CP_STOP_REASON.kick_off);break;case CP_CONSTANT.SAAS_OPERATION_CODE.queue_limit:var r=K.toast_wait_tooMany;O(r,k.KEEP_GAME_OPTION,!1,CP_CONSTANT.CP_STOP_REASON.queue_limit);break;case CP_CONSTANT.SAAS_OPERATION_CODE.stoken_refresh:break;case CP_CONSTANT.SAAS_OPERATION_CODE.resume_service:var r=K.tips_saas_service_resume;O(r,k.KEEP_GAME_OPTION,!1),Cloudplay.sceneChange("mait",{progress:"done"});break;case CP_CONSTANT.SAAS_OPERATION_CODE.ready_pause_server:var r=CP_UTILS.mixTips(K.tips_saas_ready_to_stop,[a.data.timeStr]);A(r),Cloudplay.sceneChange("mait",{progress:"soon"});break;case CP_CONSTANT.SAAS_OPERATION_CODE.pause_server:if(V&&V.isPlayerRunning())break;var r=K.tips_saas_to_stop;O(r,k.NORMAL,!1),Cloudplay.sceneChange("mait",{progress:"soon"});break;case CP_CONSTANT.SAAS_OPERATION_CODE.paused_server:var r=CP_UTILS.mixTips(K.tips_saas_already_stopped,[a.data.endTimeText]);O(r,k.NORMAL,!1),Cloudplay.sceneChange("mait",{progress:"start"})}}}catch(i){__hmLogError(null,CP_ERROR_MAP.on_saas_message_error,i.toString()),n(countly_event_id_map.saas_socket_message,["InvalidType",countly_event_custom_error.saas_message_parser_error].join(","))}}}}function N(_){var e={interval:(Date.now()-b)/1e3,reason:_};Cloudplay.sceneChange("stop",e)}function O(_,e,t,o){n(countly_event_id_map.stop_game_fun_Call,t?0:1),w.off(CP_CONSTANT.EVENT_PLAYER_ERROR),w.off(CP_CONSTANT.EVENT_PLAYER_NOT_SUPPORT),h=e;var a=CP_getCIdInfo();if(F=null,H=null,J=null,Q=-1,e_=!1,q=!1,C(),r(),CP_UTILS.isWebsocketObject(z)&&(CP_UTILS.websocket_close(z,!0),z=null,n(countly_event_id_map.saas_socket_closed,countly_event_custom_error.socket_close_by_self)),CP_hideLoadingView(),V?V.stop(_):_&&E(_),o&&N(o),h!=k.KEEP_ALL_OPTION){var T=a&&a.cid?a.cid+"":null,s=CP_localStorage.getItem(CP_CONSTANT.LOCAL_STORAGE_CIDS_KEY);T&&s&&s.hasOwnProperty(T)&&(delete s[T],CP_localStorage.setItem(CP_CONSTANT.LOCAL_STORAGE_CIDS_KEY,s)),T&&(i(a.cid),e===k.KEEP_GAME_OPTION?CP_storeCIdInfo(null):(CP_storeCIdInfo(null),CP_storeGameOptions(null)))}}function P(){if(H=null,J=null,q&&F){if(!V)return;w.off(CP_CONSTANT.EVENT_PLAYER_ERROR).on(CP_CONSTANT.EVENT_PLAYER_ERROR,function(){h||setTimeout(function(){h||w.emit(CP_CONSTANT.EVENT_RECONNECT,CP_CONSTANT.GET_CLOUD_SERVICE_TYPE_REFRESH_TOKEN)},1e3)}),w.off(CP_CONSTANT.EVENT_PLAYER_NOT_SUPPORT).on(CP_CONSTANT.EVENT_PLAYER_NOT_SUPPORT,function(){n(countly_event_id_map.device_un_support,[CP_UTILS.detectOS(),CP_UTILS.deviceType(),1].join(",")),O("",k.NORMAL,!1,CP_CONSTANT.CP_STOP_REASON.unsupport_device),V.showMessageView(CP_CONSTANT.UI_MESSAGE_TYPE_UNSUPPORT)});try{var _=F.resolutionInfo.resolution,e=_.indexOf("x");F.videoWidth=parseInt(_.substring(0,e)),F.videoHeight=parseInt(_.substring(e+1))}catch(t){return __hmLogError(null,CP_ERROR_MAP.invalid_resolution_info,JSON.stringify(F)),void O(CP_STRING.INVALID_RESOLUTION,k.NORMAL,!1,CP_CONSTANT.CP_STOP_REASON.internal_error)}V.hideMessageView(),V.startPlay(F)}}function E(_,e){H=null,J=null,F=null,V?V.showMessageView(CP_CONSTANT.UI_MESSAGE_TYPE_SYSTEM,_):e?H=_:CP_UTILS.alert(_)}function S(_){if(!M)return void O(K.toast_wait_tooMany,k.NORMAL,!1,CP_CONSTANT.CP_STOP_REASON.queue_limit);if(H=null,J=null,F=null,V){var e=function(){n(countly_event_id_map.user_continue);var _=CP_getCIdInfo();_?(Cloudplay.sceneChange("wait"),a(_,1)):E(CP_STRING.LOST_QUEUE_INFO)},t=function(){gCountly.sendCountly(countly_event_id_map.out_queue),O("",k.NORMAL,!1,CP_CONSTANT.CP_STOP_REASON.unqueue)};V.askQueuing(_,e,t),Cloudplay.sceneChange("askn")}else J=_}function A(_){V&&V.showWarnToast(_)}function l(){if(V)return void __hmLogError(null,CP_ERROR_MAP.async_load_finished_multi_call);CP_UTILS.debugAlert("load js file OK");try{V=CP_CloudplayUIInit(jQuery,n_)}catch(_){return void setTimeout(function(){l()},1e3)}return n(countly_event_id_map.async_load_finished),X&&V.setAuthData(X,K,Y,x),Cloudplay.isSupportDevice()?(Q!=-1&&(V.setCurrentResId(Q),Q=-1),F?(V.connectInputSocket(F.inputUrl,F.inputProtocol),void P()):H?void E(H):J?void S(J):void 0):(n(countly_event_id_map.device_un_support,[CP_UTILS.detectOS(),CP_UTILS.deviceType(),0].join(",")),O("",k.NORMAL,!1,CP_CONSTANT.CP_STOP_REASON.unsupport_device),void V.showMessageView(CP_CONSTANT.UI_MESSAGE_TYPE_UNSUPPORT))}function c(){if(!h){w.on(CP_CONSTANT.EVENT_NETWORK_STATUS,function(_){h!=k.NORMAL&&h!=k.KEEP_GAME_OPTION&&(_?window.location.reload():O(CP_STRING.NETWORK_UNAVALIABLE,k.KEEP_ALL_OPTION,!1,CP_CONSTANT.CP_STOP_REASON.disconnect))});var _=0;w.on(CP_CONSTANT.EVENT_PAGE_VISIBILITY,function(e){if(h!=k.NORMAL&&h!=k.KEEP_GAME_OPTION)if(e){h=k.NONE;var n=_>0&&(new Date).getTime()-_<3e4;n||e_||CP_storeCIdInfo(null),CP_showLoadingView(),setTimeout(function(){w.emit(CP_CONSTANT.EVENT_RECONNECT,n?CP_CONSTANT.GET_CLOUD_SERVICE_TYPE_REFRESH_TOKEN:CP_CONSTANT.GET_CLOUD_SERVICE_TYPE_NORMAL)},1e3),_=0}else q&&(_=(new Date).getTime()),O("",k.KEEP_ALL_OPTION,!1)}),w.on(CP_CONSTANT.EVENT_RECONNECT,function(_){return void 0!=_&&_!=-1&&(j=_),__++,__>y?void O(CP_STRING.RECONNECT_EXCCEED_MAX,k.NORMAL,!1,CP_CONSTANT.CP_STOP_REASON.internal_error):(n(countly_event_id_map.reconnecting,[h,e_].join(",")),F=null,H=null,J=null,Q=-1,q=!1,h?void A(CP_STRING.GAME_STOPED):e_?void A(CP_STRING.CONNECTING):void(Cloudplay.isOnline()&&(e_=!0,V&&V.stopPlay(!1),CP_showLoadingView(),o())))}),w.on(CP_CONSTANT.EVENT_GOT_STREAM_INFO,function(_){e_=!1,__=0,F=_,F.inputProtocol="haima-cloud-protocol",V&&V.connectInputSocket(F.inputUrl,F.inputProtocol),P()}),w.on(CP_CONSTANT.EVENT_STOP_GAME,function(_,e){O(_,k.NORMAL,!1,e?e:CP_CONSTANT.CP_STOP_REASON.internal)}),w.on(CP_CONSTANT.EVENT_PLAYER_READY,function(){CP_hideLoadingView()}),w.on(CP_CONSTANT.EVENT_REFRESH_PAGE_REQUIRE,function(){O("",k.KEEP_ALL_OPTION,!1,CP_CONSTANT.CP_STOP_REASON.need_refresh_page),V.showMessageView(CP_CONSTANT.UI_MESSAGE_TYPE_REFRESH_REQUIRED,CP_STRING.GAME_INTERRUPTED)}),Cloudplay.isAsyncLoadFinished()?l():w.once(CP_CONSTANT.EVENT_ASYNC_LOAD_FINISHED,function(_){_?l():O(CP_STRING.LOAD_JS_FAILED,k.NORMAL,!1,CP_CONSTANT.CP_STOP_REASON.async_load_js_failed)}),W=!CP_getCIdInfo(),W&&n(countly_event_id_map.start_sdk),CP_showLoadingView("startGame"),o()}}function u(){var _=CP_getGameOptions(),e=!CP_getCIdInfo()||!_||_.pkg_name!==D.pkg_name;if(e){var n=CP_getTransIndex();try{n=parseInt(n),isNaN(n)&&(n=parseInt(1e4*Math.random()))}catch(t){n=parseInt(1e4*Math.random())}n++,CP_setTransIndex(n)}return U=CP_getTransUID()+"."+CP_getTransIndex(),CP_UTILS.debugAlert("name: "+D.pkg_name+", uid: "+D.userinfo.uId+", transId: "+U),w=CP_EventEmmiterCreate(U),CP_storeGameOptions(D),Cloudplay.isInitDone()?void c():void w.once(CP_CONSTANT.EVENT_INIT_DONE,function(_,e){_?c():O(e,k.NORMAL,!1,CP_CONSTANT.CP_STOP_REASON.disconnect)})}function d(_,e,n){if(h!=k.NORMAL){var t="";n&&(t=K.prompt_game_over?K.prompt_game_over:CP_STRING.GAME_STOPED),O(t,_?k.NORMAL:k.KEEP_ALL_OPTION,e,_?CP_CONSTANT.CP_STOP_REASON.normal:null)}}function R(){w&&(w.stop(),w=null)}function I(){return U}function p(_){if(!z)return void __hmLogWarn(null,CP_ERROR_MAP.send_pay_msg_failed);var e={uid:_.uid,to:_.from,from:_.to,mid:"W"+Date.now(),type:1,ack:0,payload:_.payload};CP_UTILS.websocket_send(z,"Message",e)}function f(){return U+"_"+D.pkg_name+", isStop: "+h}function m(){return w}function v(){return h}function L(){return e_}var g=5,y=5,M=!CP_UTILS.isMobile(),k={NONE:0,NORMAL:1,KEEP_GAME_OPTION:2,KEEP_ALL_OPTION:3},h=k.NONE,D=JSON.parse(JSON.stringify(_)),G=e,U="",w=null,V=null,b=0,K={},Y={},x={},W=!0,F=null,j=CP_CONSTANT.GET_CLOUD_SERVICE_TYPE_NORMAL,q=!1,H=null,J=null,Q=-1,X=null,B=t,z=null,Z=null,$=null,__=0,e_=!1,n_=null;return n_={transId:I,start:u,stop:d,stopEventEmitter:R,sendPayMessage:p,desc:f,eventEmitter:m,isStoped:v,isReconnecting:L}};
var Cloudplay=function(){function e(){c.once(CP_CONSTANT.EVENT_REQ_DEVICE_ID_DONE,function(e,t){e?(CP_UTILS.debugAlert("did: "+t.did),t.countlyUrl&&t.countlyAppKey&&t.serverTimestamp?C.setServerInfo(t.countlyUrl,t.countlyAppKey,t.serverTimestamp):(y(countly_event_id_map.countly_invalid_data_from_get_did),__hmLogError(null,CP_ERROR_MAP.get_did_with_invalid_countly_info,[t.countlyUrl,t.countlyAppKey,t.serverTimestamp])),CP_storeDeviceId(t.did),S=!0,P&&P.eventEmitter().emit(CP_CONSTANT.EVENT_INIT_DONE,!0)):P?P.eventEmitter().emit(CP_CONSTANT.EVENT_INIT_DONE,!1,t.msg?t.msg:CP_STRING.NETWORK_ERROR):CP_UTILS.alert(t.msg?t.msg:CP_STRING.NETWORK_ERROR)}),T.reqDeviceId(c)}function t(t){return CP_UTILS.debugAlert("init sdk, dontLoadJQuery: "+(t?t.dontLoadJQuery:"")),v=CP_UTILS.isSupportDevice(),t?(I=t.MessageHandler,E=t.onSceneChanged,CP_UTILS.hasOwnProperty(t,"dontLoadJQuery")&&(m=!t.dontLoadJQuery),CP_setAccessKeyAndChannel(t.accessKeyID,t.channelId),p?(y(countly_event_id_map.init_sdk_fun_call_multi_error),void __hmLogError(null,CP_ERROR_MAP.init_sdk_fun_call_multi_error)):CP_UTILS.isPrivatedMode()&&!confirm(CP_STRING.QUERY_PRIVATE_MODE)?void y(countly_event_id_map.refuse_in_privated_mode):(CP_UTILS.hasOwnProperty(t,"recordCountlyStatisticsInfo")&&t.recordCountlyStatisticsInfo&&C.startRecordStatisticInfo(),y(countly_event_id_map.init_sdk_fun_call),p=!0,t.accessKeyID?t.channelId?t.MessageHandler?(s("init"),e()):void showMessageView(CP_STRING.INVALID_PARAM+"MessageHandler"):void showMessageView(CP_STRING.INVALID_PARAM+"channelId"):void showMessageView(CP_STRING.INVALID_PARAM+"accessKeyID"))):void CP_UTILS.alert(CP_STRING.INVALID_PARAM+"initSDK(options) is null")}function n(){return P?P.desc():"none"}function _(e){y(countly_event_id_map.start_game_fun_call,e.pkg_name),P&&(P.isStoped()||(__hmLogWarn(null,CP_ERROR_MAP.no_stop_pre_game,n()),y(countly_event_id_map.no_stop_pre_game),P.stop(!0,!1,!1)),P.stopEventEmitter(),P=null),P=CP_GameInit(e,T,y,I),P.start(e)}function a(){P&&!P.isStoped()&&P.stop(!0,!0,!0)}function r(e){P.sendPayMessage(e)}function s(e,t){try{E&&E(e,t)}catch(n){__hmLogError(null,CP_ERROR_MAP.call_on_scene_changed_error,n.toString())}}function o(){P&&(P.stop(!1,!1,!1),P.stopEventEmitter(),P=null)}function i(){o(),y(countly_event_id_map.page_closed,"unload"),C.forceSendCountlyEventWhenClosed("unload")}function l(){y(countly_event_id_map.start_async_load),s("aljs");var e=CP_UTILS.getBasePath("saas-sdk.js"),t=!1,n=null;if(e)CP_UTILS.detectOS()==CP_CONSTANT.OS_ANDROID||window.CPWorkerMode?(t=!0,n=[e+"nosleep.min.js",e+"saas-player_w.js",e+"saas-ui.js"]):n=[e+"nosleep.min.js",e+"saas-player.js",e+"saas-ui.js"],m&&n.unshift(e+"jquery-3.1.0.min.js");else{if(e=CP_UTILS.getBasePath("thirdparty/cloudplay/cloudplay.js"),n=[e+"thirdparty/nosleep/nosleep.min.js",e+"js_player/js/broadway/sylvester.js",e+"js_player/js/broadway/glUtils.js",e+"js_player/js/broadway/util.js",e+"js_player/js/broadway/canvas.js",e+"js_player/js/broadway/avc_asm_codec.js",e+"js_player/js/wsavc/wsavc.js",e+"js_player/js/audio/aurora_o.js",e+"js_player/js/audio/aac.js",e+"js_player/js/audio/aurora-websocket.min.js",e+"js_player/js_player.js",e+"thirdparty/cloudplay/cp_input.js",e+"thirdparty/cloudplay/cp_ui.js"],CP_UTILS.detectOS()==CP_CONSTANT.OS_ANDROID||window.CPWorkerMode){t=!0;var _=n.indexOf(e+"js_player/js/broadway/avc_asm_codec.js");n[_]=e+"js_player/js/broadway/worker.js",n[_+1]=e+"js_player/js/wsavc/cp_wsavc_worker.js"}m&&n.unshift(e+"thirdparty/jquery/jquery-3.1.0.min.js")}j||(j=!0,CP_AsyncLoadJsFiles(n,!0,!0,function(e,t){e?(A=!0,P&&(P.eventEmitter().emit(CP_CONSTANT.EVENT_ASYNC_LOAD_FINISHED,!0),s("alfn",{result:!0}))):(__hmLogError(null,CP_ERROR_MAP.async_load_failed,[t]),P?P.eventEmitter().emit(CP_CONSTANT.EVENT_ASYNC_LOAD_FINISHED,!1):CP_UTILS.alert(CP_STRING.LOAD_JS_FAILED),s("alfn",{result:!1}))}))}window.SDK_VERSION="feature-mobile_h5_sdk_p2-01d7a99b",window.HMCP_DEBUG=1==CP_UTILS.getUrlQueryString("hmcp_debug"),CP_StorageInit(),CP_getTransUID()||(CP_setTransUID(CryptoJS.MD5(CP_UTILS.createUID((new Date).getTime())).toString()),CP_setTransIndex(0)),CP_UTILS.debugAlert("init version: "+window.SDK_VERSION+", tid: "+CP_getTransUID()+", suri: "+SAAS_AUTH);try{var d=CP_UTILS.getUrlQueryString("hmcp_debug_uri");d&&(d=d.trim(),d=decodeURIComponent(d)),window.CP_enableLogToServer&&d&&CP_enableLogToServer(d)}catch(u){}var c=CP_EventEmmiterCreate(),C=CP_CountlyInit(),y=function(e,t){var n=P&&P.transId()?P.transId():CP_getTransUID();C.sendCountly(n,e,t)},T=CP_RequestManagerCreate(SAAS_AUTH,y),p=!1,P=null,S=!1,I=null,E=null,m=!0,N=!0,A=!1,v=!0;Uint8Array.prototype.slice||(Uint8Array.prototype.concat?Uint8Array.prototype.slice=Uint8Array.prototype.concat:Uint8Array.prototype.slice=function(){for(var e=new Uint8Array(this.length),t=0;t<this.length;t++)e[t]=this[t];return e}),CP_UTILS.isMobile()&&(window.onorientationchange=function(){var e=CP_UTILS.orientation();P&&P.eventEmitter().emit(CP_CONSTANT.EVENT_ORIENTATION_CHANGE,e)},document.addEventListener("visibilitychange",function(){P&&P.eventEmitter().emit(CP_CONSTANT.EVENT_PAGE_VISIBILITY,"visible"==document.visibilityState)})),CP_UTILS.onNetworkStatus(function(e){N=e,P&&P.eventEmitter().emit(CP_CONSTANT.EVENT_NETWORK_STATUS,N)});var j=!1;return setTimeout(function(){CP_UTILS.getBasePath("cp_ui.js")&&CP_UTILS.getBasePath("cp_input.js")||CP_UTILS.getBasePath("saas-ui.js")&&CP_UTILS.getBasePath("saas-player.js")?(A=!0,P&&(P.eventEmitter().emit(CP_CONSTANT.EVENT_ASYNC_LOAD_FINISHED,!0),s("alfn",{result:!0}))):l()},10),{initSDK:t,startGame:_,stopGame:a,sendPayMessage:r,isInitDone:function(){return S},isAsyncLoadFinished:function(){return A},isOnline:function(){return N},isSupportDevice:function(){return v},sceneChange:s,sendCountly:y,_onbeforeunload:o,_onunload:i,testReconnect:function(){P&&P.eventEmitter().emit(CP_CONSTANT.EVENT_RECONNECT,CP_CONSTANT.GET_CLOUD_SERVICE_TYPE_REFRESH_TOKEN)}}}();window.onbeforeunload=Cloudplay._onbeforeunload,window.onunload=Cloudplay._onunload;